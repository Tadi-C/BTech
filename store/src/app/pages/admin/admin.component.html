<main class="main">

  <!-- Page Title -->
  <div class="page-title dark-background" style="background-image: url(assets/img/CNC-Machining-860x280.jpg);">
    <div class="container position-relative">



    </div>
  </div><!-- End Page Title -->


<div class="container" style=" padding: 5rem;">
  <button class="button-submit" (click)="openAddProductModal()" style="margin: 3rem; width: 100px;">
    Add Product
  </button>


  <!-- This is Table that shows all the product  -->
  <div class="mat-elevation-z8" style="max-width: 90%; margin-left: 5%; margin-bottom: 20px">
    <table mat-table [dataSource]="tableDataSource" matSort>

      <ng-container matColumnDef="Name">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Name </th>
        <td style="max-width: 17rem; white-space: normal; overflow: visible;" mat-cell *matCellDef="let element">
          {{ element.Name }}
        </td>
      </ng-container>

      <!-- Description Column -->
      <ng-container matColumnDef="Brand">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Brand </th>
        <td class="truncate-cell" mat-cell *matCellDef="let element">
          {{ element.Brand }}
        </td>
      </ng-container>

      <ng-container matColumnDef="Category">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Category </th>
        <td mat-cell *matCellDef="let element"> {{ element.Category }} </td>
      </ng-container>

      <ng-container matColumnDef="Price">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Price </th>
        <td mat-cell *matCellDef="let element"> R {{ element.Price }} </td>
      </ng-container>

      <ng-container matColumnDef="Discount">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Discount </th>
        <td mat-cell *matCellDef="let element"> R {{ element.Discount_Price }} </td>
      </ng-container>

      <ng-container matColumnDef="Quantity">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Quantity </th>
        <td mat-cell *matCellDef="let element"> {{ element.Availability }} </td>
      </ng-container>



      <!-- <ng-container matColumnDef="imageData">
          <th mat-header-cell *matHeaderCellDef> Image </th>
          <td mat-cell *matCellDef="let element">
            <img style="width: 3rem; height: 3rem;" [src]="element.imageData ? element.imageData[0] : ''" alt="Image">
          </td>
        </ng-container> -->



      <ng-container matColumnDef="actions2">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let element">
        <button mat-mini-fab color="primary" (click)="openEditProductModal(element)">
          Edit
        </button>

      </td>
      </ng-container>

      <ng-container matColumnDef="actions3">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let element">
          <!-- Pass the 'element' to the OnDeleteClick method -->
          <button mat-mini-fab color="warn" (click)="deleteProduct(element.ID)">
            Delete
          </button>
        </td>
      </ng-container>



      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;" style="margin-top: 30px"></tr>
    </table>

    <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons aria-label="Select page of periodic elements">
    </mat-paginator>
  </div>

  <!--The Modal that allows for the uploading of the new modal -->
  </div>
  <div *ngIf="showAddProductModal" class="login-overlay">
    <div class="login-container">

      <form class="form">
        <div style="display: flex; align-self: flex-end">
          <mat-icon (click)="closeAddProductModal()">close</mat-icon>
        </div>

        <div class="flex-column">
          <label>Product Name </label>
        </div>
        <div class="inputForm">
          <input name="ProductName" type="text" class="input" placeholder="Product Name" [(ngModel)]="name">
        </div>

        <div class="flex-column">
          <label>Category </label>
        </div>
        <div class="inputForm">
          <input name="ProductCategory" type="text" class="input" placeholder="Category" [(ngModel)]="category">
        </div>

        <div class="flex-column">
          <label>Brand </label>
        </div>
        <div class="inputForm">
          <input name="ProductBrand" type="text" class="input" placeholder="Brand" [(ngModel)]="brand">
        </div>

        <div class="flex-column">
          <label>Description </label>
        </div>
        <div class="inputForm">
          <textarea name="ProductDescription" type="text" class="input" placeholder="Description"
            [(ngModel)]="description" cols="40" rows="6"></textarea>
        </div>



        <div class="flex-column">
          <label>Price</label>
        </div>
        <div class="inputForm">
          <input name="ProductPrice" type="number" class="input" placeholder="Price" [(ngModel)]="price">
        </div>

        <!-- <div class="flex-column">
          <label>Discount Price</label>
        </div>
        <div class="inputForm">
          <input name="ProductDiscountPrice" type="number" class="input" placeholder="Discount Price"
            [(ngModel)]="discountPrice">
        </div> -->

        <div class="flex-column">
          <label>Amount in stock</label>
        </div>
        <div class="inputForm">
          <input name="ProductAvailability" type="text" class="input" placeholder="Amount in Stock"
            [(ngModel)]="availability">
        </div>

        <div class="flex-column">
          <label>Image</label>
        </div>
        <div class="row">
          <input type="file" accept="image/*" (change)="onFileSelected($event)">
        </div>

        <button *ngIf="!editMode" class="button-submit" (click)="addProduct()">Add Product</button>
        <button *ngIf="editMode" class="button-submit" (click)="updateProduct()">Edit Product</button>

      </form>
    </div>
  </div>
</main>
